---
layout: post
title: "File Upload with jQuery and Ajax"
date: 2013-10-27T16:30:00+05:30
---

<div class='post'>
<div dir="ltr" style="text-align: left;" trbidi="on">The requirement is simple. I should be able to upload files to the server with jQuery and ajax. Lets get started.<br /><pre class="prettyprint">&lt;html&gt;<br />   &lt;form&gt;<br />     File Description:&lt;input type="text" id="desc" /&gt;<br />     Choose File:&lt;input type="file" id="chosenFile" /&gt;<br />     &lt;input type="button" id="submitFile" value="submitTheFile" /&gt;<br />   &lt;/form&gt;<br />&lt;/html&gt;<br /></pre>Now, the real jQuery stuff<br /><pre class="prettyprint">&lt;script type="text/javascript"&gt;<br />    jQuery.noConflict();<br />    jQuery(document).ready(function() {<br />        jQuery("#submitFile").click(function() {<br />            jQuery.ajax({<br />                url: "[url to be submitted to]",<br />                type: "POST",<br />                contentType: false,<br />                processData: false,<br />                data: function() {<br />                    var data = new FormData();<br />                    data.append("fileDescription", jQuery("#desc").val());<br />                    data.append("chosenFile", jQuery("#chosenFile").get(0).files[0]);<br />                    return data;<br />                    // Or simply return new FormData(jQuery("form")[0]);<br />                }(),<br />                error: function(_, textStatus, errorThrown) {<br />                    alert("Error");<br />                    console.log(textStatus, errorThrown);<br />                },<br />                success: function(response, textStatus) {<br />                    alert("Success");<br />                    console.log(response, textStatus);<br />                }<br />            });<br />        });<br />    });<br />&lt;script&gt;<br /></pre>Important things to be noted here are<br /><pre class="prettyprint">contentType: false,<br />                processData: false,<br /></pre><p><code>contentType</code> will be determined automatically, so we don't have to set that explicitly and <code>processData</code> has to be false, otherwise the data will be processed and transformed into a query string, fitting to the default content-type "application/x-www-form-urlencoded". Next important thing is<br /><pre class="prettyprint">data: function() {<br />                    var data = new FormData();<br />                    data.append("fileDescription", jQuery("#desc").val());<br />                    data.append("chosenFile", jQuery("#chosenFile").get(0).files[0]);<br />                    return data;<br />                    // Or simply return new FormData(jQuery("form")[0]);<br />                }(),<br /></pre>You can read about FormData <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData">here</a>. We basically set the values being submitted. The first parameter is the key and the second parameter is the actual value to be passed. We can get the value of any form field with <pre class="prettyprint">jQuery("#desc").val()</pre>expect the files. If we use the same for files, we ll get just the file name instead of the file contents. So, we have to do something like <pre class="prettyprint">jQuery("#chosenFile").get(0).files[0]</pre>If we dont want to set individual values and want to pass all the fields in the form, we can simply do <pre class="prettyprint">data: new FormData(jQuery("form")[0])</pre>Thats it. Enjoy Ajaxified file upload :)<br /><b>References:</b><br /><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData">FormData</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/File">File</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications">Using files from web applications</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Using_FormData_Objects">Using FormData Objects</a></li></ul></div></div>
